<html>
    <script>
        window.onload = function() {
            var body = window.location.href
            let parts = body.split('&')
            var state = ""
            var nonce = ""
            for (let part of parts) {
                if (part.startsWith('state')) {
                    state = part.split('=')[1];
                }
                if (part.startsWith('nonce')) {
                    nonce = part.split('=')[1];
                }
            }

            // will be passed by Azure B2C
            client_id = ""
            redirect_uri = ""
            response_type = ""
            response_mode = ""
            scope = ""
            // alert(body + ";;" + state + ";;" + nonce);
            // window.location.href = "https://appleid.apple.com/auth/authorize?client_id=com.fitpassu.fitpassu.beta.azureb2c&redirect_uri=https://vilacaps.com/.netlify/functions/azure-b2c-sign-in-with-apple-proxy&response_type=code&scope=name email&response_mode=form_post&state=" + state + "&nonce=" + nonce;
            window.location.href = "https://appleid.apple.com/auth/authorize?client_id=com.fitpassu.fitpassu.beta.azureb2c&redirect_uri=https://fitpassuprod.b2clogin.com/fitpassuprod.onmicrosoft.com/oauth2/authresp&response_type=code&scope=name email&response_mode=form_post&state=" + state + "&nonce=" + nonce;
        }
    </script>
<body>
    Signing in...
</body>
</html>